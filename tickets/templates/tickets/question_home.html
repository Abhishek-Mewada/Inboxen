{# Copyright (c) 2015 Jessica Tallon & Matt Molyneaux. This file is part of Inboxen. Licensed under the terms of the GNU AGPL, as published by the FSF, version 3 the or later #}
{% extends 'inboxen/base.html' %}
{% load i18n humanize bootstrap %}

{% block breadcumbs %}
    <ul class="breadcrumb">
        <li><a href="{% url 'termsofservice-index' %}">{% trans "Help" %}</a></li>
        <li class="active">{% trans "Questions" %}</li>
    </ul>
{% endblock %}

{% block content %}
<span class="sr-only"><a href="#question-form">{% trans "Go to Question form" %}</a></span>

<div class="table-responsive">
    <table class="table table-hover table-honeydew">
        <thead>
            <tr>
                <th>{% trans "Subject" %}</th>
                <th>{% trans "Responses" %}</th>
                <th>{% trans "Status" %}</th>
                <th>{% trans "Last Activity" %}</th>
            </tr>
        </thead>
        <tbody>
        {% for question in open %}
            <tr>
                <td><a href="{% url 'tickets-detail' pk=question.pk %}">{{ question.subject }}</a></td>
                <td>{{ question.response_count }}</td>
                <td>{{ question.get_status_display }}</td>
                <td title="{{ question.last_activity|date:"r" }}">{{ question.last_activity|naturaltime }}</td>
            </tr>
            {% if forloop.last %}
                <tr><td colspan=4><div class="pull-right"><a class="btn btn-info" href="{% url "tickets-list" status="!resolved" %}">{% trans "More Open Tickets" %}</a></div></td></tr>
            {% endif %}
        {% empty %}
            <tr>
                <td colspan=4>{% trans "There are no open questions." %}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
<div class="table-responsive">
    <table class="table table-hover table-honeydew">
        <thead>
            <tr>
                <th>{% trans "Subject" %}</th>
                <th>{% trans "Responses" %}</th>
                <th>{% trans "Status" %}</th>
                <th>{% trans "Last Activity" %}</th>
            </tr>
        </thead>
        <tbody>
        {% for question in closed %}
            <tr>
                <td><a href="{% url 'tickets-detail' pk=question.pk %}">{{ question.subject }}</a></td>
                <td>{{ question.response_count }}</td>
                <td>{{ question.get_status_display }}</td>
                <td title="{{ question.last_activity|date:"r" }}">{{ question.last_activity|naturaltime }}</td>
            </tr>
            {% if forloop.last %}
                <tr><td colspan=4><div class="pull-right"><a class="btn btn-danger" href="{% url "tickets-list" status="resolved" %}">{% trans "More Closed Tickets" %}</a></div></td></tr>
            {% endif %}
        {% empty %}
            <tr>
                <td colspan=4>{% trans "There are no closed questions." %}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
<div class="panel panel-default col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4">
    <div class="panel-body">
        <form id="question-form" class="form" method="post" action="{% url 'tickets-index' %}">
            {% csrf_token %}
            {{ form|bootstrap }}
            <button class="btn btn-primary">{% trans "Submit" %}</button>
        </form>
    </div>
</div>
{% endblock %}
