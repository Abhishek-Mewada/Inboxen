{# Copyright (c) 2015 Jessica Tallon & Matt Molyneaux. This file is part of Inboxen. Licensed under the terms of the GNU AGPL, as published by the FSF, version 3 the or later #}
{% extends 'account/index.html' %}
{% load two_factor i18n inboxen_account %}

{% block navigation %}
    {% account_menu 'user-security' %}
{% endblock %}

{% block form %}
{% if default_device %}
    {% if default_device_type == 'TOTPDevice' %}
        <p>{% trans "Tokens will be generated by your token generator." %}</p>
    {% elif default_device_type == 'PhoneDevice' %}
        <p>{% blocktrans with primary=default_device|device_action %}Primary method: {{ primary }}{% endblocktrans %}</p>
    {% elif default_device_type == 'RemoteYubikeyDevice' %}
        <p>{% blocktrans %}Tokens will be generated by your YubiKey.{% endblocktrans %}</p>
    {% endif %}

    <p>{% blocktrans %}
        If you wish to disable two factor authentication on this account, click
        the button below.
    {% endblocktrans %}</p>
    <p><a class="btn btn-danger" href="{% url 'user-twofactor-disable' %}">
        {% trans "Disable Two Factor Authentication" %}</a></p>
    <hr>
    <p>
        {% trans "If you don't have you device with you, you can access your account using backup tokens." %}
        <p>{% if backup_tokens %}
            {% blocktrans count counter=backup_tokens %}
                You have only one backup token remaining.
            {% plural %}
                You have {{ counter }} backup tokens remaining.
            {% endblocktrans %}
        {% else %}
            {% trans "You do not have any backup tokens" %}
        {% endif %}</p>
    </p>
    <p>
        <a href="{% url 'user-twofactor-backup' %}" class="btn btn-primary">{% trans "Backup Tokens" %}</a>
    </p>
{% else %}
    <p>{% blocktrans %}
        Two-factor authentication is not enabled for your account. Enable
        two-factor authentication for enhanced account security.
    {% endblocktrans %}</p>
    <p><a href="{% url 'user-twofactor-setup' %}" class="btn btn-primary">
        {% trans "Enable Two-Factor Authentication" %}
    </a></p>
{% endif %}
<hr>
<p>{% trans "You can change your password here." %}</p>
    <p><a class="btn btn-primary" href="{% url 'user-password' %}">
        {% trans "Change password" %}</a></p>
{% endblock %}
